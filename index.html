<!DOCTYPE html>
<html>

<head>
    <title>Archiving Royals as JSON - Poor Charles II</title>
    <link rel="stylesheet" type="text/css" href="themes.css">
    <link rel="apple-touch-icon" sizes="180x180" href="./apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="./favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="./favicon-16x16.png">
    <link rel="manifest" href="./site.webmanifest">
    <link rel="mask-icon" href="./safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="theme-color" content="#ffffff">
    
    <script src="https://dagrejs.github.io/project/dagre-d3/latest/dagre-d3.min.js"></script>
    <script src="https://dagrejs.github.io/project/dagre/latest/dagre.min.js"></script>
    <script src="https://d3js.org/d3.v5.min.js"></script>
    <script src="https://underscorejs.org/underscore-min.js"></script>
</head>

<body>

    <div class="page">
    
        <h1>Royal Family Tree</h1>
        <div id="frame" style="text-align: center">
            <svg class="d3" width="1000" height="500"><g/></svg>
        </div>
            <p>Family tree of Charles II of Spain</p>
        
        <!-- REMEMBER TO UPDATE DATE -->
        
    </div>
    
    <footer>
        <p class="infooter">
            <u class="fakelink">Royal Family Tree</u> | 
            <u class="fakelink">Site made by Janice</u> | 
            <u class="fakelink">Created: 06/08/19</u> | 
            <u class="fakelink">Updated: 10/08/19</u> | 
            <u class="fakelink" onclick="window.history.back()">Go Back</u>
        </p>
    </footer>
</body>
    
<script>
    var json = `

[
  {
    "id": 0,
    "name": "Woden",
    "mother": "",
    "father": "",
    "class": "legendary saxon male ruler",
    "birthday": "",
    "deathday": ""
  },
  {
    "id": 1,
    "name": "Bældæg",
    "mother": "",
    "father": 0,
    "class": "legendary saxon male ruler",
    "birthday": "",
    "deathday": ""
  },
  {
    "id": 2,
    "name": "Brond",
    "mother": "",
    "father": 1,
    "class": "legendary saxon male ruler",
    "birthday": "",
    "deathday": ""
  },
  {
    "id": 3,
    "name": "Freawine",
    "mother": "",
    "father": 2,
    "class": "legendary saxon male ruler",
    "birthday": "",
    "deathday": ""
  },
  {
    "id": 4,
    "name": "Wig",
    "mother": "",
    "father": 3,
    "class": "legendary saxon male ruler",
    "birthday": "",
    "deathday": ""
  },
  {
    "id": 5,
    "name": "Giwis",
    "mother": "",
    "father": 4,
    "class": "legendary saxon male ruler",
    "birthday": "",
    "deathday": ""
  },
  {
    "id": 6,
    "name": "Elesa",
    "mother": "",
    "father": 5,
    "class": "legendary saxon male ruler",
    "birthday": "",
    "deathday": ""
  },
  {
    "id": 7,
    "name": "Cerdic",
    "mother": "",
    "father": 6,
    "class": "legendary saxon male ruler",
    "birthday": "",
    "deathday": 534
  },
  {
    "id": 8,
    "name": "Cynric",
    "mother": "",
    "father": 7,
    "class": "wessex anglo-saxon male ruler",
    "birthday": "",
    "deathday": 560
  },
  {
    "id": 9,
    "name": "Ceawlin",
    "mother": "",
    "father": 8,
    "class": "wessex anglo-saxon male ruler",
    "birthday": "",
    "deathday": 593
  },
  {
    "id": 10,
    "name": "Cuthwulf",
    "mother": "",
    "father": 8,
    "class": "wessex anglo-saxon male ruler",
    "birthday": "",
    "deathday": ""
  }
]

`;
        
        
    var data = JSON.parse(json);
    alert(data[0].name);
    
    
    
    var dagre = dagreD3.dagre;
    var g = new dagreD3.graphlib.Graph();
    
    // Set an object for the graph label
    g.setGraph({
        ranksep: 50,
        nodesep: 50,
        rankdir: 'TB',
        ranker: 'longest-path'
    });
    
    // Default to assigning a new object as a label for each new edge.
    g.setDefaultEdgeLabel(function() { return {}; });
    
    
    // Add nodes
    var i; //should be same as data[i].id
    
    for (i = 0; i < data.length; i++) { //sets a whole bunch of nodes
        g.setNode("node-" + data[i].id, { label: data[i].name, class: data[i].class }); //create node
    }
    
    // Add edges
    
    for (i = 0; i < data.length; i++) { //sets a whole bunch of edges
        
        if (data[i].mother !== "") { //if mother is not blank, draw line between mother and child
            g.setEdge("node-" + data[(data[i].mother)], "node-" + data[i].id, { curve: d3.curveBasis });
        }
        if (data[i].father !== "") { //if father is not blank, draw line between father and child
            g.setEdge("node-" + data[(data[i].father)], "node-" + data[i].id, { curve: d3.curveBasis });
        }
    }
    
    
    /* charles ii
    g.setNode("charles",          { label: "Charles II of Spain",               class: "male ruler" });
    g.setNode("philipiv",         { label: "Philip IV of Spain",                class: "male ruler" });
    g.setNode("marianaii",        { label: "Maria Anna of Austria",             class: "female" });
    g.setNode("philipiii",        { label: "Philip III of Spain",               class: "male ruler" });
    g.setNode("margaret",         { label: "Margaret of Austria",               class: "female" });
    g.setNode("ferdinand",        { label: "Ferdinand III, Holy Roman Emperor", class: "male ruler" });
    g.setNode("marianai",         { label: "Maria Anna of Spain",               class: "female ruler" });
    g.setEdge("philipiv",         "charles",          { curve: d3.curveBasis });
    g.setEdge("marianaii",        "charles",          { curve: d3.curveBasis });
    g.setEdge("philipiii",        "philipiv",         { curve: d3.curveBasis });
    g.setEdge("margaret",         "philipiv",         { curve: d3.curveBasis });
    g.setEdge("ferdinand",        "marianaii",        { curve: d3.curveBasis });
    g.setEdge("marianai",         "marianaii",        { curve: d3.curveBasis });
    */
    
    // Set up an SVG group so that we can translate the final graph.
    var svg = d3.select('svg'),
        inner = svg.select('g');
        svgGroup = svg.append('g');
    
    // Set up zoom support
    var zoom = d3.zoom().on("zoom", function() {
        inner.attr("transform", d3.event.transform);
    });
    svg.call(zoom);
    
    
    
    
    
    var EDGE_DEFAULT_ATTRS = {
  arrowhead: "normal",
  lineInterpolate: "linear"
};
    
    g.edges().forEach(function(e) {
      var edge = g.edge(e);
      if (typeof edge === "undefined") {
        g.setEdge(e, {});
        edge = g.edge(e);
      }
      if (!_.has(edge, "label")) { edge.label = ""; }
      _.defaults(edge, EDGE_DEFAULT_ATTRS);
    });
    
    
    
    // Create the renderer
    var render = new dagreD3.render();
    // Run the renderer. This is what draws the final graph.
    render(d3.select('.d3 g'), g);
    var initialScale = 0.75;
    svg.call(zoom.transform, d3.zoomIdentity.translate((svg.attr("width") - g.graph().width * initialScale) / 2, 20).scale(initialScale));
    //svg.attr('height', g.graph().height * initialScale + 40);
</script>
</html>
